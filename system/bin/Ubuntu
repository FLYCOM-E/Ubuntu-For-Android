#!/system/bin/sh
UBUNTUPATH="/data/Ubuntu"

"$UBUNTUPATH/busybox" mount -o remount,dev,suid /data 2>/dev/null
"$UBUNTUPATH/busybox" mount --bind /dev "$UBUNTUPATH/dev" 2>/dev/null
"$UBUNTUPATH/busybox" mount --bind /sys "$UBUNTUPATH/sys" 2>/dev/null
"$UBUNTUPATH/busybox" mount --bind /proc "$UBUNTUPATH/proc" 2>/dev/null
"$UBUNTUPATH/busybox" mount -t devpts devpts "$UBUNTUPATH/dev/pts" 2>/dev/null
"$UBUNTUPATH/busybox" mount --bind /sdcard "$UBUNTUPATH/sdcard" 2>/dev/null

clear
echo "\033[1;3;96m===============================\033[0m\n"
echo "\033[1;93m Ubuntu Start\033[0m\n"
echo "\033[1;3;96m===============================\033[0m\n"
"$UBUNTUPATH/busybox" chroot "$UBUNTUPATH" /bin/bash -c "
    export PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$PATH\";
    export TMPDIR=/tmp;
    groupadd -g 3003 aid_inet 2>/dev/null;
    groupadd -g 3004 aid_net_raw 2>/dev/null;
    groupadd -g 1003 aid_graphics 2>/dev/null;
    usermod -g 3003 -G 3003,3004 -a _apt 2>/dev/null;
    usermod -G 3003 -a root 2>/dev/null;
    cd /root;
    exec su"
if [ "$?" != "0" ]; then
    echo -n "\n\033[1;91m>>> Ubuntu is error exit.\n>>> Enter exit\033[0m"
    read i && exit 0
fi

"$UBUNTUPATH/busybox" umount "$UBUNTUPATH/dev/pts" 2>/dev/null
"$UBUNTUPATH/busybox" umount "$UBUNTUPATH/dev" 2>/dev/null
"$UBUNTUPATH/busybox" umount "$UBUNTUPATH/proc" 2>/dev/null
"$UBUNTUPATH/busybox" umount "$UBUNTUPATH/sys" 2>/dev/null
"$UBUNTUPATH/busybox" umount "$UBUNTUPATH/sdcard" 2>/dev/null
true
